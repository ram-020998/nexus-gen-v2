<!-- Interface Comparison Component -->
{% if comparison and comparison.object_type == 'Interface' %}
<div class="comparison-section">
    <div class="comparison-header">
        <h5><i class="fas fa-window-maximize"></i> Interface Details</h5>
    </div>
    
    <div class="comparison-body">
        <!-- Parameters Section -->
        <div class="subsection">
            <h6><i class="fas fa-sliders-h"></i> Interface Parameters</h6>
            <div class="comparison-grid">
                {% if detail.change.classification == 'CONFLICT' %}
                    <!-- CONFLICT: Vendor Latest (left) vs Customer (right) -->
                    <div class="version-column vendor-column">
                        <div class="version-header">
                            <span class="badge bg-info">{{ comparison.old_label or 'Vendor Latest' }}</span>
                        </div>
                        <div class="version-content">
                            {% if comparison.vendor.parameters %}
                            <table class="params-table">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Type</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for param in comparison.vendor.parameters %}
                                    <tr>
                                        <td>{{ param.name }}</td>
                                        <td>{{ param.type }}</td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                            {% else %}
                            <p class="text-muted">No parameters</p>
                            {% endif %}
                        </div>
                    </div>
                    
                    <div class="version-column customer-column">
                        <div class="version-header">
                            <span class="badge bg-success">{{ comparison.new_label or 'Customer' }}</span>
                        </div>
                        <div class="version-content">
                            {% if comparison.customer.parameters %}
                            <table class="params-table">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Type</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for param in comparison.customer.parameters %}
                                    {% set vendor_param = comparison.vendor.parameters | selectattr('name', 'equalto', param.name) | first %}
                                    <tr class="{% if not vendor_param %}highlight-added{% elif vendor_param.type != param.type %}highlight-diff{% endif %}">
                                        <td>{{ param.name }}</td>
                                        <td>{{ param.type }}</td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                            {% else %}
                            <p class="text-muted">No parameters</p>
                            {% endif %}
                        </div>
                    </div>
                {% else %}
                    <!-- NO_CONFLICT: Dynamic based on change types -->
                    <div class="version-column vendor-column">
                        <div class="version-header">
                            <span class="badge bg-secondary">{{ comparison.old_label or 'Vendor Base' }}</span>
                        </div>
                        <div class="version-content">
                            {% if comparison.customer.parameters %}
                            <table class="params-table">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Type</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for param in comparison.customer.parameters %}
                                    <tr>
                                        <td>{{ param.name }}</td>
                                        <td>{{ param.type }}</td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                            {% else %}
                            <p class="text-muted">No parameters</p>
                            {% endif %}
                        </div>
                    </div>
                    
                    <div class="version-column customer-column">
                        <div class="version-header">
                            <span class="badge bg-info">{{ comparison.new_label or 'Vendor Latest' }}</span>
                        </div>
                        <div class="version-content">
                            {% if comparison.vendor.parameters %}
                            <table class="params-table">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Type</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for param in comparison.vendor.parameters %}
                                    {% set base_param = comparison.customer.parameters | selectattr('name', 'equalto', param.name) | first %}
                                    <tr class="{% if not base_param %}highlight-added{% elif base_param.type != param.type %}highlight-diff{% endif %}">
                                        <td>{{ param.name }}</td>
                                        <td>{{ param.type }}</td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                            {% else %}
                            <p class="text-muted">No parameters</p>
                            {% endif %}
                        </div>
                    </div>
                {% endif %}
            </div>
        </div>
        
        <!-- SAIL Code Section -->
        <div class="subsection">
            <h6><i class="fas fa-code"></i> SAIL Code Differences</h6>
            {% if comparison.diff_hunks is defined %}
                {% from "merge/comparisons/_sail_diff.html" import render_sail_diff %}
                {{ render_sail_diff(comparison.diff_hunks, old_label=comparison.old_label, new_label=comparison.new_label, stats=comparison.diff_stats) }}
            {% else %}
                <div class="code-diff-container">
                    {% if detail.change.classification == 'CONFLICT' %}
                        <!-- CONFLICT: Vendor Latest (left) vs Customer (right) -->
                        <div class="code-diff-column vendor-version">
                            <div class="code-diff-header">
                                <div class="code-diff-label">
                                    <i class="fas fa-cube"></i>
                                    <span>{{ comparison.old_label or 'Vendor Latest' }}</span>
                                </div>
                                <span class="code-diff-badge vendor">{{ comparison.old_label or 'New Version' }}</span>
                            </div>
                            <div class="code-diff-body">
                                {% if comparison.vendor.sail_code %}
                                <pre><code class="language-sail">{{ comparison.vendor.sail_code | e }}</code></pre>
                                {% else %}
                                <div class="code-empty-state">
                                    <i class="fas fa-code"></i>
                                    <p>No code available</p>
                                </div>
                                {% endif %}
                            </div>
                        </div>
                        
                        <div class="code-diff-column customer-version">
                            <div class="code-diff-header">
                                <div class="code-diff-label">
                                    <i class="fas fa-user"></i>
                                    <span>{{ comparison.new_label or 'Customer' }}</span>
                                </div>
                                <span class="code-diff-badge customer">{{ comparison.new_label or 'Current' }}</span>
                            </div>
                            <div class="code-diff-body">
                                {% if comparison.customer.sail_code %}
                                <pre><code class="language-sail">{{ comparison.customer.sail_code | e }}</code></pre>
                                {% else %}
                                <div class="code-empty-state">
                                    <i class="fas fa-code"></i>
                                    <p>No code available</p>
                                </div>
                                {% endif %}
                            </div>
                        </div>
                    {% else %}
                        <!-- NO_CONFLICT: Vendor Base (left) vs Vendor Latest (right) -->
                        <div class="code-diff-column vendor-version">
                            <div class="code-diff-header">
                                <div class="code-diff-label">
                                    <i class="fas fa-cube"></i>
                                    <span>{{ comparison.old_label or 'Vendor Base' }}</span>
                                </div>
                                <span class="code-diff-badge vendor">{{ comparison.old_label or 'Base Version' }}</span>
                            </div>
                            <div class="code-diff-body">
                                {% if comparison.customer.sail_code %}
                                <pre><code class="language-sail">{{ comparison.customer.sail_code | e }}</code></pre>
                                {% else %}
                                <div class="code-empty-state">
                                    <i class="fas fa-code"></i>
                                    <p>No code available</p>
                                </div>
                                {% endif %}
                            </div>
                        </div>
                        
                        <div class="code-diff-column customer-version">
                            <div class="code-diff-header">
                                <div class="code-diff-label">
                                    <i class="fas fa-cube"></i>
                                    <span>{{ comparison.new_label or 'Vendor Latest' }}</span>
                                </div>
                                <span class="code-diff-badge vendor">{{ comparison.new_label or 'New Version' }}</span>
                            </div>
                            <div class="code-diff-body">
                                {% if comparison.vendor.sail_code %}
                                <pre><code class="language-sail">{{ comparison.vendor.sail_code | e }}</code></pre>
                                {% else %}
                                <div class="code-empty-state">
                                    <i class="fas fa-code"></i>
                                    <p>No code available</p>
                                </div>
                                {% endif %}
                            </div>
                        </div>
                    {% endif %}
                </div>
            {% endif %}
        </div>
    </div>
</div>
{% endif %}
