# Requirements Document

## Introduction

The Three-Way Merge Assistant is a feature designed to help Appian application customers upgrade from a customized version of a vendor application to a newer vendor release while preserving their customizations. When customers customize vendor applications and then want to adopt new vendor releases, they face significant challenges in understanding what new features and changes the vendor introduced that they need to incorporate into their customized version. This feature provides a guided, step-by-step process to help users identify vendor changes, understand how those changes interact with their customizations, and manually apply necessary updates to adopt new vendor features while retaining their custom modifications.

## Glossary

- **Base Package (A)**: The original vendor application version that the customer initially installed (e.g., GSS 1.0.0)
- **Customized Package (B)**: The customer's modified version of the base package, containing their customizations (e.g., GSS 1.0.0 CUS 1.0)
- **New Vendor Package (C)**: The latest vendor release that the customer wants to adopt (e.g., GSS 2.0.0)
- **Three-Way Comparison**: Analysis comparing Base (A) to both Customized (B) and New Vendor (C) to identify customer changes and vendor changes
- **Merge Session**: A saved workflow state tracking user progress through the merge process
- **Change Classification**: Categorization of changes based on conflict status and merge complexity
- **Conflict**: A situation where both customer and vendor modified the same object differently from the base
- **Blueprint**: A structured representation of an Appian application package generated by the analyzer
- **Object**: An Appian application component (Interface, Process Model, Record Type, Expression Rule, etc.)
- **Dependency Chain**: The hierarchical relationship between objects where child objects reference parent objects

## Requirements

### Requirement 1

**User Story:** As a customer administrator, I want to upload three application packages (base, customized, and new vendor version), so that the system can analyze the differences and guide me through the upgrade process.

#### Acceptance Criteria

1. WHEN a user navigates to the merge assistant page THEN the system SHALL display three distinct upload sections for Base Package (A), Customized Package (B), and New Vendor Package (C)
2. WHEN a user uploads a ZIP file to any section THEN the system SHALL validate that the file is a valid Appian application package
3. WHEN all three packages are uploaded THEN the system SHALL enable a "Start Analysis" button
4. WHEN a user clicks "Start Analysis" THEN the system SHALL create a new merge session and store the session identifier
5. WHEN package validation fails THEN the system SHALL display a clear error message indicating which package is invalid and why

### Requirement 2

**User Story:** As a customer administrator, I want the system to generate blueprints for all three packages, so that I can understand the structure and content of each version.

#### Acceptance Criteria

1. WHEN a merge session starts THEN the system SHALL generate blueprints for all three packages (A, B, C) using the existing analyzer
2. WHEN blueprint generation completes for a package THEN the system SHALL store the blueprint with the merge session
3. WHEN blueprint generation fails for any package THEN the system SHALL mark the session as failed and display the error details
4. WHEN all blueprints are generated THEN the system SHALL proceed to the comparison phase automatically
5. WHILE blueprint generation is in progress THEN the system SHALL display progress indicators for each package

### Requirement 3

**User Story:** As a customer administrator, I want the system to compare the base package with the new vendor package, so that I can identify all vendor changes in the new release.

#### Acceptance Criteria

1. WHEN blueprints are available THEN the system SHALL compare Base (A) with New Vendor (C) to identify vendor changes
2. WHEN comparing A and C THEN the system SHALL identify objects that are ADDED, MODIFIED, or REMOVED in the new vendor version
3. WHEN vendor changes are identified THEN the system SHALL store the comparison results with change types and details
4. WHEN an object is modified THEN the system SHALL capture the specific changes (SAIL code, fields, properties, business logic)
5. WHEN comparison completes THEN the system SHALL proceed to customer change analysis

### Requirement 4

**User Story:** As a customer administrator, I want the system to compare the base package with my customized package, so that I can identify all customizations I have made.

#### Acceptance Criteria

1. WHEN blueprints are available THEN the system SHALL compare Base (A) with Customized (B) to identify customer changes
2. WHEN comparing A and B THEN the system SHALL identify objects that are ADDED, MODIFIED, or REMOVED by the customer
3. WHEN customer changes are identified THEN the system SHALL store the comparison results with change types and details
4. WHEN an object is modified THEN the system SHALL capture the specific changes (SAIL code, fields, properties, business logic)
5. WHEN comparison completes THEN the system SHALL proceed to conflict detection

### Requirement 5

**User Story:** As a customer administrator, I want the system to detect conflicts between my customizations and vendor changes, so that I know which objects require careful review.

#### Acceptance Criteria

1. WHEN both vendor changes (A→C) and customer changes (A→B) are available THEN the system SHALL identify conflicts where the same object was modified in both
2. WHEN analyzing changes THEN the system SHALL classify each object into one of four categories: NO_CONFLICT, CONFLICT, CUSTOMER_ONLY, or REMOVED_BUT_CUSTOMIZED
3. WHEN an object exists only in vendor changes (A→C) and not in customer changes (A→B) THEN the system SHALL classify it as NO_CONFLICT
4. WHEN an object is modified in both vendor changes (A→C) and customer changes (A→B) THEN the system SHALL classify it as CONFLICT
5. WHEN an object is modified only in customer changes (A→B) THEN the system SHALL classify it as CUSTOMER_ONLY
6. WHEN an object is removed in vendor changes (A→C) but modified in customer changes (A→B) THEN the system SHALL classify it as REMOVED_BUT_CUSTOMIZED
7. WHEN conflict detection completes THEN the system SHALL store classification results with the merge session

### Requirement 6

**User Story:** As a customer administrator, I want to see a summary of all changes organized by classification, so that I can understand the scope and complexity of the merge.

#### Acceptance Criteria

1. WHEN analysis completes THEN the system SHALL display a merge summary page showing counts for each classification category
2. WHEN displaying the summary THEN the system SHALL show the total number of objects in each category: NO_CONFLICT, CONFLICT, CUSTOMER_ONLY, REMOVED_BUT_CUSTOMIZED
3. WHEN displaying the summary THEN the system SHALL show the breakdown by object type (Interfaces, Process Models, Record Types, etc.) for each category
4. WHEN a user views the summary THEN the system SHALL provide a "Start Merge Workflow" button to begin the guided process
5. WHEN displaying the summary THEN the system SHALL indicate estimated time or complexity based on the number of conflicts

### Requirement 7

**User Story:** As a customer administrator, I want to review changes in a smart order (starting with easy, non-conflicting changes), so that I can make quick progress and build confidence before tackling complex conflicts.

#### Acceptance Criteria

1. WHEN a user starts the merge workflow THEN the system SHALL present changes in the following order: NO_CONFLICT first, then CONFLICT, then REMOVED_BUT_CUSTOMIZED
2. WHEN presenting NO_CONFLICT changes THEN the system SHALL group them by object type
3. WHEN presenting CONFLICT changes THEN the system SHALL order them by dependency hierarchy (parent objects before child objects)
4. WHEN a circular dependency is detected THEN the system SHALL break the cycle and present objects in a reasonable order with a warning
5. WHEN ordering is complete THEN the system SHALL store the ordered change list with the merge session

### Requirement 8

**User Story:** As a customer administrator, I want to review each vendor change one at a time with clear guidance on how to incorporate it into my customized version, so that I can adopt new vendor features while preserving my customizations.

#### Acceptance Criteria

1. WHEN a user views a change THEN the system SHALL display the object name, type, and classification category
2. WHEN a user views a NO_CONFLICT change THEN the system SHALL show the vendor changes (A→C) with guidance on what new features or modifications to add to the customized version
3. WHEN a user views a CONFLICT change THEN the system SHALL display a three-way diff showing Base (A), Customer (B), and Vendor (C) versions side-by-side with the customer version (B) as the starting point
4. WHEN a user views a CONFLICT change THEN the system SHALL highlight which vendor changes (from A→C) need to be incorporated into the customer version (B) while preserving customer modifications
5. WHEN a user views a REMOVED_BUT_CUSTOMIZED change THEN the system SHALL show the customer modifications and indicate the vendor removed this object with a recommendation to keep the customer version
6. WHEN displaying changes THEN the system SHALL provide action buttons: "Mark as Reviewed", "Skip", "Add Notes"
7. WHEN a user adds notes THEN the system SHALL store the notes with the change record
8. WHEN a user marks a change as reviewed THEN the system SHALL update the session state and proceed to the next change

### Requirement 9

**User Story:** As a customer administrator, I want to see three-way diffs for conflicting objects with clear indication of what vendor changes I need to incorporate into my customized version, so that I can adopt new vendor features while keeping my customizations.

#### Acceptance Criteria

1. WHEN displaying a CONFLICT change THEN the system SHALL show three columns: Base (A), Customer (B), and Vendor (C)
2. WHEN displaying SAIL code in the diff THEN the system SHALL highlight vendor additions (A→C) that need to be incorporated into customer version (B)
3. WHEN displaying SAIL code THEN the system SHALL format the code with proper indentation and replace UUIDs with readable object names
4. WHEN displaying object properties THEN the system SHALL highlight which vendor changes (A→C) need to be added to the customer version while preserving customer-specific modifications
5. WHEN both customer and vendor modified the same section THEN the system SHALL clearly mark the overlapping section and provide guidance on how to merge both changes
6. WHEN displaying a CONFLICT change THEN the system SHALL provide a "Suggested Merge Strategy" section explaining how to incorporate vendor changes into the customer version

### Requirement 10

**User Story:** As a customer administrator, I want to track my progress through the merge workflow, so that I can see how much work remains and resume later if needed.

#### Acceptance Criteria

1. WHEN a user is in the merge workflow THEN the system SHALL display a progress indicator showing current position and total changes
2. WHEN a user marks a change as reviewed THEN the system SHALL update the progress counter
3. WHEN a user skips a change THEN the system SHALL mark it as skipped and update the progress counter
4. WHEN a user navigates away THEN the system SHALL save the current session state to the database
5. WHEN a user returns to a merge session THEN the system SHALL restore the session state and resume from the last reviewed change

### Requirement 11

**User Story:** As a customer administrator, I want to navigate between changes (previous/next) and jump to specific changes, so that I can review changes in a flexible manner.

#### Acceptance Criteria

1. WHEN viewing a change THEN the system SHALL provide "Previous" and "Next" navigation buttons
2. WHEN on the first change THEN the system SHALL disable the "Previous" button
3. WHEN on the last change THEN the system SHALL display a "Complete Review" button instead of "Next"
4. WHEN a user clicks "Complete Review" THEN the system SHALL navigate to the merge report page
5. WHEN viewing a change THEN the system SHALL provide a sidebar or dropdown to jump to any change in the list

### Requirement 12

**User Story:** As a customer administrator, I want to generate a merge report at the end of the workflow, so that I have a comprehensive document of all changes and actions taken.

#### Acceptance Criteria

1. WHEN a user completes the merge workflow THEN the system SHALL generate a merge report
2. WHEN generating the report THEN the system SHALL include summary statistics (total changes, reviewed, skipped, conflicts)
3. WHEN generating the report THEN the system SHALL list all changes with their classification, review status, and user notes
4. WHEN generating the report THEN the system SHALL group changes by category and object type
5. WHEN the report is generated THEN the system SHALL provide options to download as PDF or JSON
6. WHEN the report is generated THEN the system SHALL store it with the merge session for future reference

### Requirement 13

**User Story:** As a customer administrator, I want to filter and search changes in the merge workflow, so that I can quickly find specific objects or types of changes.

#### Acceptance Criteria

1. WHEN viewing the change list THEN the system SHALL provide filter options for classification category, object type, and review status
2. WHEN a user applies a filter THEN the system SHALL update the change list to show only matching changes
3. WHEN viewing the change list THEN the system SHALL provide a search box to find changes by object name
4. WHEN a user searches for an object THEN the system SHALL highlight matching objects in the change list
5. WHEN filters or search are applied THEN the system SHALL maintain the smart ordering within the filtered results

### Requirement 14

**User Story:** As a customer administrator, I want to view dependency information for each object, so that I understand the impact of changes on related objects.

#### Acceptance Criteria

1. WHEN viewing a change THEN the system SHALL display a list of parent objects (dependencies) that this object references
2. WHEN viewing a change THEN the system SHALL display a list of child objects that reference this object
3. WHEN displaying dependencies THEN the system SHALL indicate the review status of each dependent object (reviewed, pending, skipped)
4. WHEN a dependency has not been reviewed THEN the system SHALL provide a link to jump to that dependency
5. WHEN displaying dependencies THEN the system SHALL highlight dependencies that are also in the change list

### Requirement 15

**User Story:** As a customer administrator, I want the system to identify specific vendor changes that need to be incorporated into my customized objects, so that I know exactly what to add or modify.

#### Acceptance Criteria

1. WHEN analyzing a CONFLICT change THEN the system SHALL identify specific vendor additions (new functions, new fields, new logic) that do not exist in the customer version
2. WHEN analyzing a CONFLICT change THEN the system SHALL identify vendor modifications to shared sections that need to be evaluated for incorporation
3. WHEN displaying vendor changes to incorporate THEN the system SHALL provide line-by-line or section-by-section guidance
4. WHEN vendor added new functionality THEN the system SHALL highlight the new code blocks and suggest where they should be added in the customer version
5. WHEN vendor modified existing functionality THEN the system SHALL show the before/after and explain what changed and why it might be important to adopt

### Requirement 16

**User Story:** As a system administrator, I want merge sessions to be persisted in the database, so that users can resume their work and sessions are not lost.

#### Acceptance Criteria

1. WHEN a merge session is created THEN the system SHALL store session metadata (session ID, user, timestamps, package names)
2. WHEN blueprints are generated THEN the system SHALL store all three blueprints with the session
3. WHEN comparisons are completed THEN the system SHALL store comparison results and classifications with the session
4. WHEN a user reviews changes THEN the system SHALL update the session state in real-time
5. WHEN a user adds notes or marks changes THEN the system SHALL persist these actions to the database immediately
6. WHEN a session is completed THEN the system SHALL mark it as completed and store the final merge report

### Requirement 17

**User Story:** As a customer administrator, I want to see examples and recommendations for common merge scenarios, so that I can understand best practices for incorporating vendor changes.

#### Acceptance Criteria

1. WHEN viewing a CONFLICT change THEN the system SHALL provide merge strategy recommendations based on the type of conflict
2. WHEN vendor added new validation logic THEN the system SHALL recommend adding it to the customer version with guidance on placement
3. WHEN vendor refactored code structure THEN the system SHALL explain the refactoring and suggest whether to adopt it
4. WHEN vendor added new UI components THEN the system SHALL show where to integrate them in the customer's customized UI
5. WHEN vendor changed data models THEN the system SHALL highlight the schema changes and their implications for customer customizations
